title: Reverse Shell Execution
id: openclaw-007
status: stable
description: Detects common reverse shell patterns including bash, netcat, python, perl, ruby, and PHP-based reverse shells
author: OpenClaw Security
date: 2026/02/25
logsource:
  category: process_creation
  product: any
detection:
  selection_bash_reverse:
    category: 'process_creation'
    metadata_command_line|contains:
      - 'bash -i >& /dev/tcp/'
      - 'bash -c "bash -i'
      - '/bin/bash -i > /dev/tcp/'
      - 'sh -i >& /dev/tcp/'
      - '0>&1'
      - 'bash -i >& /dev/udp/'
  selection_netcat_reverse:
    category: 'process_creation'
    metadata_command_line|contains:
      - 'nc -e /bin/sh'
      - 'nc -e /bin/bash'
      - 'nc -c bash'
      - 'ncat -e /bin/sh'
      - 'ncat -e /bin/bash'
      - 'nc.traditional -e'
      - 'nc -lvp'
      - 'ncat --sh-exec'
  selection_python_reverse:
    category: 'process_creation'
    metadata_command_line|contains:
      - 'python -c "import socket'
      - 'python3 -c "import socket'
      - 'python -c "import os,pty,socket'
      - 'python3 -c "import os,pty,socket'
      - "python -c 'import socket"
      - "python3 -c 'import socket"
      - 'pty.spawn'
  selection_perl_ruby_php:
    category: 'process_creation'
    metadata_command_line|contains:
      - 'perl -e "use Socket'
      - "perl -e 'use Socket"
      - 'perl -MIO -e'
      - 'ruby -rsocket -e'
      - "ruby -rsocket -e'"
      - 'php -r "$sock=fsockopen'
      - "php -r '$sock=fsockopen"
  selection_socat_reverse:
    category: 'process_creation'
    metadata_command_line|contains:
      - 'socat exec:'
      - 'socat tcp-connect:'
      - 'socat TCP4:'
      - 'mkfifo /tmp/'
      - 'mknod /tmp/ p'
  condition: selection_bash_reverse OR selection_netcat_reverse OR selection_python_reverse OR selection_perl_ruby_php OR selection_socat_reverse
level: critical
tags:
  - attack.execution
  - attack.t1059
falsepositives:
  - Legitimate penetration testing activities
  - Security tool demonstrations in controlled environments
references:
  - https://attack.mitre.org/techniques/T1059/
  - https://attack.mitre.org/techniques/T1059/004/

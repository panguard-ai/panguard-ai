title: Credential Dumping Attempt
id: panguard-008
status: stable
description: Detects credential dumping tools and techniques including mimikatz, gsecdump, shadow file access, SAM database extraction, and LSASS memory access
author: Panguard AI
date: 2026/02/25
logsource:
  category: process_creation
  product: any
detection:
  selection_mimikatz:
    category: 'process_creation'
    metadata_command_line|contains:
      - 'mimikatz'
      - 'sekurlsa::logonpasswords'
      - 'sekurlsa::wdigest'
      - 'sekurlsa::kerberos'
      - 'lsadump::sam'
      - 'lsadump::dcsync'
      - 'lsadump::lsa /patch'
      - 'token::elevate'
      - 'privilege::debug'
  selection_credential_tools:
    category: 'process_creation'
    metadata_command_line|contains:
      - 'gsecdump'
      - 'wce.exe'
      - 'pwdump'
      - 'fgdump'
      - 'procdump -ma lsass'
      - 'procdump.exe -accepteula -ma lsass'
      - 'crackmapexec'
      - 'secretsdump'
      - 'impacket-secretsdump'
      - 'pypykatz'
  selection_shadow_access:
    category: 'process_creation'
    metadata_command_line|contains:
      - 'cat /etc/shadow'
      - 'cat /etc/passwd'
      - 'unshadow'
      - 'john /etc/shadow'
      - 'hashcat'
      - '/etc/shadow'
      - 'cat /etc/master.passwd'
  selection_sam_registry:
    category: 'process_creation'
    metadata_command_line|contains:
      - 'reg save hklm\\sam'
      - 'reg save hklm\\security'
      - 'reg save hklm\\system'
      - 'vssadmin create shadow'
      - 'copy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy'
      - 'ntdsutil'
  selection_lsass_access:
    category: 'process_creation'
    metadata_command_line|contains:
      - 'lsass.dmp'
      - 'lsass.exe'
      - 'comsvcs.dll, MiniDump'
      - 'comsvcs.dll MiniDump'
      - 'rundll32 comsvcs'
    description|contains:
      - 'credential dump'
      - 'password dump'
      - 'hash dump'
      - 'lsass memory'
  condition: selection_mimikatz OR selection_credential_tools OR selection_shadow_access OR selection_sam_registry OR selection_lsass_access
level: critical
tags:
  - attack.credential_access
  - attack.t1003
falsepositives:
  - Legitimate security auditing tools used by authorized personnel
  - Backup processes that access system authentication databases
references:
  - https://attack.mitre.org/techniques/T1003/
  - https://attack.mitre.org/techniques/T1003/001/
